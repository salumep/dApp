[
  {
    "type": "constructor",
    "inputs": [
      {
        "name": "_collateralToken",
        "type": "address",
        "internalType": "address"
      },
      {
        "name": "_liquidityPool",
        "type": "address",
        "internalType": "address"
      },
      { "name": "_priceOracle", "type": "address", "internalType": "address" }
    ],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "applyFundingRate",
    "inputs": [
      { "name": "traders", "type": "address[]", "internalType": "address[]" },
      { "name": "assets", "type": "address[]", "internalType": "address[]" },
      {
        "name": "positionIds",
        "type": "uint256[]",
        "internalType": "uint256[]"
      },
      { "name": "adjustments", "type": "int256[]", "internalType": "int256[]" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "assetPrices",
    "inputs": [{ "name": "", "type": "address", "internalType": "address" }],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "assetToCollateral",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "assetAmount", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "autoDeleverage",
    "inputs": [
      { "name": "traders", "type": "address[]", "internalType": "address[]" },
      { "name": "assets", "type": "address[]", "internalType": "address[]" },
      {
        "name": "positionIds",
        "type": "uint256[]",
        "internalType": "uint256[]"
      },
      {
        "name": "reductionAmounts",
        "type": "uint256[]",
        "internalType": "uint256[]"
      }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "autoDeleverageThreshold",
    "inputs": [],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "cancelOrder",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "orderId", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "closePosition",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "positionId", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "collateralToken",
    "inputs": [],
    "outputs": [
      { "name": "", "type": "address", "internalType": "contract IERC20" }
    ],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "deposit",
    "inputs": [
      { "name": "amount", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "executeStopLossOrTakeProfit",
    "inputs": [
      { "name": "trader", "type": "address", "internalType": "address" },
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "orderId", "type": "uint256", "internalType": "uint256" },
      {
        "name": "executionPrice",
        "type": "uint256",
        "internalType": "uint256"
      },
      { "name": "isStopLoss", "type": "bool", "internalType": "bool" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "getBuyOrdersCount",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" }
    ],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "getLatestPrice",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" }
    ],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "getMarginLevel",
    "inputs": [
      { "name": "user", "type": "address", "internalType": "address" },
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "positionId", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "getOrder",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "orderId", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [
      {
        "name": "",
        "type": "tuple",
        "internalType": "struct Orderbook.Order",
        "components": [
          { "name": "price", "type": "uint256", "internalType": "uint256" },
          {
            "name": "stopLossPrice",
            "type": "uint256",
            "internalType": "uint256"
          },
          {
            "name": "takeProfitPrice",
            "type": "uint256",
            "internalType": "uint256"
          },
          { "name": "amount", "type": "uint256", "internalType": "uint256" },
          { "name": "filled", "type": "uint256", "internalType": "uint256" },
          { "name": "trader", "type": "address", "internalType": "address" },
          { "name": "isBuyOrder", "type": "bool", "internalType": "bool" },
          {
            "name": "orderType",
            "type": "uint8",
            "internalType": "enum Orderbook.OrderType"
          },
          { "name": "isFilled", "type": "bool", "internalType": "bool" },
          {
            "name": "expiration",
            "type": "uint256",
            "internalType": "uint256"
          },
          { "name": "leverage", "type": "uint256", "internalType": "uint256" },
          {
            "name": "marginType",
            "type": "uint8",
            "internalType": "enum Orderbook.MarginType"
          },
          { "name": "asset", "type": "address", "internalType": "address" }
        ]
      }
    ],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "getSellOrdersCount",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" }
    ],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "getUserPositions",
    "inputs": [
      { "name": "user", "type": "address", "internalType": "address" },
      { "name": "asset", "type": "address", "internalType": "address" }
    ],
    "outputs": [
      { "name": "", "type": "uint256[]", "internalType": "uint256[]" },
      {
        "name": "",
        "type": "tuple[]",
        "internalType": "struct Orderbook.Position[]",
        "components": [
          { "name": "size", "type": "uint256", "internalType": "uint256" },
          {
            "name": "entryPrice",
            "type": "uint256",
            "internalType": "uint256"
          },
          { "name": "isLong", "type": "bool", "internalType": "bool" },
          { "name": "leverage", "type": "uint256", "internalType": "uint256" },
          {
            "name": "collateral",
            "type": "uint256",
            "internalType": "uint256"
          },
          {
            "name": "marginType",
            "type": "uint8",
            "internalType": "enum Orderbook.MarginType"
          },
          { "name": "asset", "type": "address", "internalType": "address" }
        ]
      }
    ],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "insuranceFund",
    "inputs": [],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "liquidatePosition",
    "inputs": [
      { "name": "trader", "type": "address", "internalType": "address" },
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "positionId", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "liquidationThreshold",
    "inputs": [],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "liquidityPool",
    "inputs": [],
    "outputs": [
      {
        "name": "",
        "type": "address",
        "internalType": "contract ILiquidityPool"
      }
    ],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "orders",
    "inputs": [
      { "name": "", "type": "address", "internalType": "address" },
      { "name": "", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [
      { "name": "price", "type": "uint256", "internalType": "uint256" },
      { "name": "stopLossPrice", "type": "uint256", "internalType": "uint256" },
      {
        "name": "takeProfitPrice",
        "type": "uint256",
        "internalType": "uint256"
      },
      { "name": "amount", "type": "uint256", "internalType": "uint256" },
      { "name": "filled", "type": "uint256", "internalType": "uint256" },
      { "name": "trader", "type": "address", "internalType": "address" },
      { "name": "isBuyOrder", "type": "bool", "internalType": "bool" },
      {
        "name": "orderType",
        "type": "uint8",
        "internalType": "enum Orderbook.OrderType"
      },
      { "name": "isFilled", "type": "bool", "internalType": "bool" },
      { "name": "expiration", "type": "uint256", "internalType": "uint256" },
      { "name": "leverage", "type": "uint256", "internalType": "uint256" },
      {
        "name": "marginType",
        "type": "uint8",
        "internalType": "enum Orderbook.MarginType"
      },
      { "name": "asset", "type": "address", "internalType": "address" }
    ],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "owner",
    "inputs": [],
    "outputs": [{ "name": "", "type": "address", "internalType": "address" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "placeLimitOrder",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "price", "type": "uint256", "internalType": "uint256" },
      { "name": "stopLossPrice", "type": "uint256", "internalType": "uint256" },
      {
        "name": "takeProfitPrice",
        "type": "uint256",
        "internalType": "uint256"
      },
      { "name": "amount", "type": "uint256", "internalType": "uint256" },
      { "name": "isBuyOrder", "type": "bool", "internalType": "bool" },
      { "name": "expiration", "type": "uint256", "internalType": "uint256" },
      { "name": "leverage", "type": "uint256", "internalType": "uint256" },
      {
        "name": "marginType",
        "type": "uint8",
        "internalType": "enum Orderbook.MarginType"
      }
    ],
    "outputs": [
      { "name": "orderId", "type": "uint256", "internalType": "uint256" }
    ],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "placeMarketOrder",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "amount", "type": "uint256", "internalType": "uint256" },
      { "name": "isBuyOrder", "type": "bool", "internalType": "bool" },
      { "name": "leverage", "type": "uint256", "internalType": "uint256" },
      {
        "name": "marginType",
        "type": "uint8",
        "internalType": "enum Orderbook.MarginType"
      }
    ],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "positions",
    "inputs": [
      { "name": "", "type": "address", "internalType": "address" },
      { "name": "", "type": "address", "internalType": "address" },
      { "name": "", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [
      { "name": "size", "type": "uint256", "internalType": "uint256" },
      { "name": "entryPrice", "type": "uint256", "internalType": "uint256" },
      { "name": "isLong", "type": "bool", "internalType": "bool" },
      { "name": "leverage", "type": "uint256", "internalType": "uint256" },
      { "name": "collateral", "type": "uint256", "internalType": "uint256" },
      {
        "name": "marginType",
        "type": "uint8",
        "internalType": "enum Orderbook.MarginType"
      },
      { "name": "asset", "type": "address", "internalType": "address" }
    ],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "priceOracle",
    "inputs": [],
    "outputs": [
      {
        "name": "",
        "type": "address",
        "internalType": "contract AggregatorV3Interface"
      }
    ],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "priceOracles",
    "inputs": [{ "name": "", "type": "address", "internalType": "address" }],
    "outputs": [
      {
        "name": "",
        "type": "address",
        "internalType": "contract AggregatorV3Interface"
      }
    ],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "renounceOwnership",
    "inputs": [],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "setAssetPrice",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "price", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "setAutoDeleverageThreshold",
    "inputs": [
      { "name": "newThreshold", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "setLiquidationThreshold",
    "inputs": [
      { "name": "newThreshold", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "setPriceOracle",
    "inputs": [
      { "name": "asset", "type": "address", "internalType": "address" },
      { "name": "oracle", "type": "address", "internalType": "address" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "totalLongVolume",
    "inputs": [{ "name": "", "type": "address", "internalType": "address" }],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "totalShortVolume",
    "inputs": [{ "name": "", "type": "address", "internalType": "address" }],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "transferOwnership",
    "inputs": [
      { "name": "newOwner", "type": "address", "internalType": "address" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "userBalances",
    "inputs": [{ "name": "", "type": "address", "internalType": "address" }],
    "outputs": [{ "name": "", "type": "uint256", "internalType": "uint256" }],
    "stateMutability": "view"
  },
  {
    "type": "function",
    "name": "withdraw",
    "inputs": [
      { "name": "amount", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "function",
    "name": "withdrawInsuranceFund",
    "inputs": [
      { "name": "amount", "type": "uint256", "internalType": "uint256" }
    ],
    "outputs": [],
    "stateMutability": "nonpayable"
  },
  {
    "type": "event",
    "name": "AutoDeleveraged",
    "inputs": [
      {
        "name": "positionId",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "reductionAmount",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "asset",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "Deposit",
    "inputs": [
      {
        "name": "user",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      },
      {
        "name": "amount",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "FundingRateApplied",
    "inputs": [
      {
        "name": "positionId",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "adjustment",
        "type": "int256",
        "indexed": false,
        "internalType": "int256"
      },
      {
        "name": "asset",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "OrderCancelled",
    "inputs": [
      {
        "name": "orderId",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "trader",
        "type": "address",
        "indexed": false,
        "internalType": "address"
      },
      {
        "name": "isBuyOrder",
        "type": "bool",
        "indexed": false,
        "internalType": "bool"
      },
      {
        "name": "remainingAmount",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "asset",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "OrderFilledByLiquidityPool",
    "inputs": [
      {
        "name": "orderId",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "filledAmount",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "executionPrice",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "asset",
        "type": "address",
        "indexed": false,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "OrderMatched",
    "inputs": [
      {
        "name": "buyOrderId",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "sellOrderId",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "matchedAmount",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "price",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "asset",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "OrderPlaced",
    "inputs": [
      {
        "name": "orderId",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "trader",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      },
      {
        "name": "orderType",
        "type": "uint8",
        "indexed": false,
        "internalType": "enum Orderbook.OrderType"
      },
      {
        "name": "price",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "amount",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "stopLossPrice",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "takeProfitPrice",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "expiration",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "asset",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "OwnershipTransferred",
    "inputs": [
      {
        "name": "previousOwner",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      },
      {
        "name": "newOwner",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "PositionClosed",
    "inputs": [
      {
        "name": "trader",
        "type": "address",
        "indexed": false,
        "internalType": "address"
      },
      {
        "name": "orderId",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "closeAmount",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "executionPrice",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "pnl",
        "type": "int256",
        "indexed": false,
        "internalType": "int256"
      },
      {
        "name": "asset",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "PositionLiquidated",
    "inputs": [
      {
        "name": "trader",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      },
      {
        "name": "positionId",
        "type": "uint256",
        "indexed": true,
        "internalType": "uint256"
      },
      {
        "name": "amount",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "price",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "asset",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "PositionUpdated",
    "inputs": [
      {
        "name": "trader",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      },
      {
        "name": "positionId",
        "type": "uint256",
        "indexed": true,
        "internalType": "uint256"
      },
      {
        "name": "size",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "entryPrice",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "isLong",
        "type": "bool",
        "indexed": false,
        "internalType": "bool"
      },
      {
        "name": "leverage",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "margin",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      },
      {
        "name": "marginType",
        "type": "uint8",
        "indexed": false,
        "internalType": "enum Orderbook.MarginType"
      },
      {
        "name": "asset",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      }
    ],
    "anonymous": false
  },
  {
    "type": "event",
    "name": "Withdraw",
    "inputs": [
      {
        "name": "user",
        "type": "address",
        "indexed": true,
        "internalType": "address"
      },
      {
        "name": "amount",
        "type": "uint256",
        "indexed": false,
        "internalType": "uint256"
      }
    ],
    "anonymous": false
  },
  {
    "type": "error",
    "name": "ExpirationOver",
    "inputs": [
      { "name": "expiration", "type": "uint256", "internalType": "uint256" },
      { "name": "currentTime", "type": "uint256", "internalType": "uint256" }
    ]
  },
  { "type": "error", "name": "OrderAlreadyFilled", "inputs": [] },
  { "type": "error", "name": "OrderNotFound", "inputs": [] },
  {
    "type": "error",
    "name": "OwnableInvalidOwner",
    "inputs": [
      { "name": "owner", "type": "address", "internalType": "address" }
    ]
  },
  {
    "type": "error",
    "name": "OwnableUnauthorizedAccount",
    "inputs": [
      { "name": "account", "type": "address", "internalType": "address" }
    ]
  },
  { "type": "error", "name": "PositionNotFound", "inputs": [] },
  { "type": "error", "name": "ReentrancyGuardReentrantCall", "inputs": [] },
  { "type": "error", "name": "UnauthorizedCancellation", "inputs": [] },
  { "type": "error", "name": "UnauthorizedClosing", "inputs": [] },
  {
    "type": "error",
    "name": "UnderPricedStopLoss",
    "inputs": [
      { "name": "stopLossPrice", "type": "uint256", "internalType": "uint256" },
      { "name": "currentPrice", "type": "uint256", "internalType": "uint256" }
    ]
  }
]
